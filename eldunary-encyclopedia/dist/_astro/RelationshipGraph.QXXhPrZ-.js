import{_ as w}from"./preload-helper.CLcXU_4U.js";import{j as p}from"./jsx-runtime.TBa3i5EZ.js";import{r as g}from"./index.CVf8TyFT.js";function A({data:m,highlightSlug:a,onNodeClick:h}){const i=g.useRef(null),s=g.useRef(null);return g.useEffect(()=>{if(!i.current||!s.current)return;const{nodes:c,edges:d}=m;c.length&&w(()=>import("./index.YKLKnyE1.js"),[]).then(r=>{const y=s.current,u=y.clientWidth||800,x=y.clientHeight||600,o=r.select(i.current);o.selectAll("*").remove(),o.attr("width",u).attr("height",x);const l=o.append("g"),v=r.zoom().scaleExtent([.1,4]).on("zoom",t=>l.attr("transform",t.transform));o.call(v);const f=r.forceSimulation(c).force("link",r.forceLink(d).id(t=>t.id).distance(80)).force("charge",r.forceManyBody().strength(-150)).force("center",r.forceCenter(u/2,x/2)).force("collision",r.forceCollide(20)),k=l.append("g").selectAll("line").data(d).enter().append("line").attr("stroke","rgba(255,255,255,0.1)").attr("stroke-width",1),n=l.append("g").selectAll("g").data(c).enter().append("g").attr("cursor","pointer").call(r.drag().on("start",(t,e)=>{t.active||f.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}).on("drag",(t,e)=>{e.fx=t.x,e.fy=t.y}).on("end",(t,e)=>{t.active||f.alphaTarget(0),e.fx=null,e.fy=null}));n.append("circle").attr("r",t=>t.id===a?10:6).attr("fill",t=>t.accentColor??"#C49B5C").attr("stroke",t=>t.id===a?"#fff":"rgba(255,255,255,0.2)").attr("stroke-width",t=>t.id===a?2:1).attr("opacity",.9),n.append("text").text(t=>t.name).attr("x",8).attr("y",4).attr("fill","#F5F0E8").attr("font-size","10px").attr("font-family","Inter, sans-serif").attr("pointer-events","none"),n.on("click",(t,e)=>{if(h)h(e);else{const _={race:"races",kingdom:"kingdoms",city:"cities",character:"characters",arashi:"arashi",organization:"organizations",family:"families",history:"history",magic:"magic",language:"languages"}[e.type]??e.type;window.location.href=`/${_}/${e.id}`}}),f.on("tick",()=>{k.attr("x1",t=>t.source.x??0).attr("y1",t=>t.source.y??0).attr("x2",t=>t.target.x??0).attr("y2",t=>t.target.y??0),n.attr("transform",t=>`translate(${t.x??0},${t.y??0})`)})})},[m,a]),p.jsxs("div",{ref:s,style:{width:"100%",height:"100%",minHeight:"600px",background:"#0A0A0F",borderRadius:"8px",position:"relative"},children:[p.jsx("svg",{ref:i,style:{width:"100%",height:"100%"}}),p.jsx("div",{style:{position:"absolute",bottom:"1rem",left:"1rem",fontSize:"0.7rem",color:"rgba(255,255,255,0.3)"},children:"Drag to move • Scroll to zoom • Click node to navigate"})]})}export{A as default};
