import{_ as b}from"./preload-helper.CLcXU_4U.js";import{j as p}from"./jsx-runtime.TBa3i5EZ.js";import{r as y}from"./index.CVf8TyFT.js";import{g as v,S as m,s as w}from"./graph-edge-styles.76vo30I8.js";function j({slug:a,nodes:s,edges:g}){const c=y.useRef(null);return y.useEffect(()=>{!c.current||!s.length||b(()=>import("./index.YKLKnyE1.js"),[]).then(e=>{const n=e.select(c.current);n.selectAll("*").remove(),n.attr("width",280).attr("height",220).attr("viewBox","0 0 280 220");const f=s.map(t=>({...t})),h=g.map(t=>({source:typeof t.source=="string"?t.source:t.source.id,target:typeof t.target=="string"?t.target:t.target.id,type:t.type??"mentioned"})),d=e.forceSimulation(f).force("link",e.forceLink(h).id(t=>t.id).distance(58)).force("charge",e.forceManyBody().strength(-90)).force("center",e.forceCenter(280/2,220/2)).force("collision",e.forceCollide(14)),u=n.append("g").selectAll("line").data(h).enter().append("line").each(function(t){const r=v(t.type);e.select(this).attr("stroke",r.stroke).attr("stroke-width",Math.min(r.strokeWidth,1.5)).attr("stroke-dasharray",r.strokeDasharray??null).attr("opacity",r.opacity*.85)}),o=n.append("g").selectAll("g").data(f).enter().append("g").attr("cursor","pointer");function x(t){const l=t.id===a?56:32,i=m[t.type]??m.character;if(i.symbolName==="shield")return w(Math.sqrt(l/Math.PI));const k=e[i.symbolName]??e.symbolCircle;return e.symbol().type(k).size(l)()??""}o.append("path").attr("d",t=>x(t)).attr("fill",t=>t.accentColor??"#C49B5C").attr("stroke",t=>t.id===a?"#fff":"rgba(255,255,255,0.18)").attr("stroke-width",t=>t.id===a?1.5:.8).attr("opacity",.9),o.filter(t=>t.type==="arashi"&&t.rank!=null).append("text").text(t=>String(t.rank)).attr("text-anchor","middle").attr("dominant-baseline","central").attr("fill","#fff").attr("font-size","5px").attr("font-weight","bold").attr("pointer-events","none"),o.append("text").text(t=>t.name.length>14?t.name.slice(0,13)+"â€¦":t.name).attr("x",7).attr("y",4).attr("fill","#F5F0E8").attr("font-size","8px").attr("pointer-events","none"),o.on("click",(t,r)=>{if(r.id===a)return;const i={race:"races",kingdom:"kingdoms",city:"cities",character:"characters",arashi:"arashi",organization:"organizations",family:"families",history:"history",magic:"magic",language:"languages"}[r.type]??r.type;window.location.href=`/${i}/${r.id}`}),d.on("tick",()=>{u.attr("x1",t=>typeof t.source=="string"?0:t.source.x??0).attr("y1",t=>typeof t.source=="string"?0:t.source.y??0).attr("x2",t=>typeof t.target=="string"?0:t.target.x??0).attr("y2",t=>typeof t.target=="string"?0:t.target.y??0),o.attr("transform",t=>`translate(${t.x??0},${t.y??0})`)})})},[a,s,g]),p.jsxs("div",{style:{background:"rgba(10,10,15,0.6)",borderRadius:"8px",padding:"0.5rem",border:"1px solid rgba(255,255,255,0.06)"},children:[p.jsx("div",{style:{fontSize:"0.65rem",textTransform:"uppercase",letterSpacing:"0.1em",color:"rgba(255,255,255,0.3)",marginBottom:"4px",padding:"0 4px"},children:"Connections"}),p.jsx("svg",{ref:c,style:{display:"block"}})]})}export{j as default};
